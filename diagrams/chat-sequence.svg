<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="496px" preserveAspectRatio="none" style="width:664px;height:496px;background:#F9F9F9;" version="1.1" viewBox="0 0 664 496" width="664px" zoomAndPan="magnify"><defs/><g><rect fill="#F9F9F9" height="496" style="stroke:transparent;stroke-width:1;" width="664" x="0" y="0"/><rect fill="#E0D4F7" height="484.0547" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:0.5;" width="152.3477" x="61.9561" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="116.1113" x="80.0742" y="18.0669">Request Thread</text><rect fill="#FFFFE0" height="484.0547" rx="3.5" ry="3.5" style="stroke:#181818;stroke-width:0.5;" width="239.3252" x="304.5117" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="87.8008" x="380.2739" y="18.0669">Thread Pool</text><g><title>Worker Thread</title><rect fill="#FFFFFF" height="71.2656" style="stroke:#393939;stroke-width:1;" width="10" x="475.6616" y="191.8281"/></g><g><title>User</title><rect fill="transparent" height="329.4609" width="8" x="19.9551" y="81.2969"/><line style="stroke:#393939;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="23" x2="23" y1="81.2969" y2="410.7578"/></g><g><title>Request Coroutine</title><rect fill="transparent" height="329.4609" width="8" x="134.1299" y="81.2969"/><line style="stroke:#393939;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="137.9561" x2="137.9561" y1="81.2969" y2="410.7578"/></g><g><title>Task Queue</title><rect fill="transparent" height="329.4609" width="8" x="355.999" y="81.2969"/><line style="stroke:#393939;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="359.5117" x2="359.5117" y1="81.2969" y2="410.7578"/></g><g><title>Worker Thread</title><rect fill="transparent" height="329.4609" width="8" x="476.6616" y="81.2969"/><line style="stroke:#393939;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="480.4863" x2="480.4863" y1="81.2969" y2="410.7578"/></g><text fill="#191919" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31.9102" x="5" y="77.9951">User</text><ellipse cx="23.9551" cy="13.5" fill="#191919" rx="8" ry="8" style="stroke:#191919;stroke-width:0.5;"/><path d="M23.9551,21.5 L23.9551,48.5 M10.9551,29.5 L36.9551,29.5 M23.9551,48.5 L10.9551,63.5 M23.9551,48.5 L36.9551,63.5 " fill="transparent" style="stroke:#191919;stroke-width:0.5;"/><text fill="#191919" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31.9102" x="5" y="422.7529">User</text><ellipse cx="23.9551" cy="434.5547" fill="#191919" rx="8" ry="8" style="stroke:#191919;stroke-width:0.5;"/><path d="M23.9551,442.5547 L23.9551,469.5547 M10.9551,450.5547 L36.9551,450.5547 M23.9551,469.5547 L10.9551,484.5547 M23.9551,469.5547 L36.9551,484.5547 " fill="transparent" style="stroke:#191919;stroke-width:0.5;"/><rect fill="#E55756" height="30.2969" rx="3.5" ry="3.5" style="stroke:#191919;stroke-width:1.5;" width="144.3477" x="65.9561" y="50"/><text fill="#F9F9F9" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="130.3477" x="72.9561" y="69.9951">Request Coroutine</text><rect fill="#E55756" height="30.2969" rx="3.5" ry="3.5" style="stroke:#191919;stroke-width:1.5;" width="144.3477" x="65.9561" y="409.7578"/><text fill="#F9F9F9" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="130.3477" x="72.9561" y="429.7529">Request Coroutine</text><path d="M313.5117,55 L406.4863,55 C411.4863,55 411.4863,68.1484 411.4863,68.1484 C411.4863,68.1484 411.4863,81.2969 406.4863,81.2969 L313.5117,81.2969 C308.5117,81.2969 308.5117,68.1484 308.5117,68.1484 C308.5117,68.1484 308.5117,55 313.5117,55 " fill="#E55756" style="stroke:#191919;stroke-width:1.5;"/><path d="M406.4863,55 C401.4863,55 401.4863,68.1484 401.4863,68.1484 C401.4863,81.2969 406.4863,81.2969 406.4863,81.2969 " fill="transparent" style="stroke:#191919;stroke-width:1.5;"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.9746" x="313.5117" y="72.9951">Task Queue</text><path d="M313.5117,409.7578 L406.4863,409.7578 C411.4863,409.7578 411.4863,422.9063 411.4863,422.9063 C411.4863,422.9063 411.4863,436.0547 406.4863,436.0547 L313.5117,436.0547 C308.5117,436.0547 308.5117,422.9063 308.5117,422.9063 C308.5117,422.9063 308.5117,409.7578 313.5117,409.7578 " fill="#E55756" style="stroke:#191919;stroke-width:1.5;"/><path d="M406.4863,409.7578 C401.4863,409.7578 401.4863,422.9063 401.4863,422.9063 C401.4863,436.0547 406.4863,436.0547 406.4863,436.0547 " fill="transparent" style="stroke:#191919;stroke-width:1.5;"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.9746" x="313.5117" y="427.7529">Task Queue</text><rect fill="#E55756" height="30.2969" rx="3.5" ry="3.5" style="stroke:#191919;stroke-width:1.5;" width="118.3506" x="421.4863" y="50"/><text fill="#F9F9F9" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="104.3506" x="428.4863" y="69.9951">Worker Thread</text><rect fill="#E55756" height="30.2969" rx="3.5" ry="3.5" style="stroke:#191919;stroke-width:1.5;" width="118.3506" x="421.4863" y="409.7578"/><text fill="#F9F9F9" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="104.3506" x="428.4863" y="429.7529">Worker Thread</text><g><title>Worker Thread</title><rect fill="#FFFFFF" height="71.2656" style="stroke:#393939;stroke-width:1;" width="10" x="475.6616" y="191.8281"/></g><polygon fill="#191919" points="126.1299,108.4297,136.1299,112.4297,126.1299,116.4297,130.1299,112.4297" style="stroke:#191919;stroke-width:1;"/><line style="stroke:#191919;stroke-width:1;" x1="23.9551" x2="132.1299" y1="112.4297" y2="112.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="90.1748" x="30.9551" y="107.3638">Upload image</text><polygon fill="#191919" points="347.999,148.1289,357.999,152.1289,347.999,156.1289,351.999,152.1289" style="stroke:#191919;stroke-width:1;"/><line style="stroke:#191919;stroke-width:1;" x1="138.1299" x2="353.999" y1="152.1289" y2="152.1289"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="197.8691" x="145.1299" y="147.063">Enqueue task and await result</text><path d="M364,128.9297 L364,161.9297 A3.5,3.5 0 0 0 367.5,165.4297 L514.5,165.4297 A3.5,3.5 0 0 0 518,161.9297 L518,135.4297 L508,125.4297 L367.5,125.4297 A3.5,3.5 0 0 0 364,128.9297 " fill="#E5E5E5" style="stroke:#191919;stroke-width:1.5;"/><path d="M508,125.4297 L508,133.6797 A1.75,1.75 0 0 0 509.75,135.4297 L518,135.4297 L508,125.4297 " fill="#E5E5E5" style="stroke:#191919;stroke-width:1.5;"/><text fill="#191919" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133.0786" x="370" y="142.4966">Coroutine suspends,</text><text fill="#191919" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97.2842" x="370" y="157.6294">waits for result</text><polygon fill="#191919" points="463.6616,187.8281,473.6616,191.8281,463.6616,195.8281,467.6616,191.8281" style="stroke:#191919;stroke-width:1;"/><line style="stroke:#191919;stroke-width:1;" x1="359.999" x2="469.6616" y1="191.8281" y2="191.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="90.2319" x="366.999" y="186.7622">Dequeue task</text><line style="stroke:#191919;stroke-width:1;" x1="485.6616" x2="527.6616" y1="220.9609" y2="220.9609"/><line style="stroke:#191919;stroke-width:1;" x1="527.6616" x2="527.6616" y1="220.9609" y2="233.9609"/><line style="stroke:#191919;stroke-width:1;" x1="486.6616" x2="527.6616" y1="233.9609" y2="233.9609"/><polygon fill="#191919" points="496.6616,229.9609,486.6616,233.9609,496.6616,237.9609,492.6616,233.9609" style="stroke:#191919;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164.8613" x="492.6616" y="215.895">CPU-intensive processing</text><polygon fill="#191919" points="370.999,259.0938,360.999,263.0938,370.999,267.0938,366.999,263.0938" style="stroke:#191919;stroke-width:1;"/><line style="stroke:#191919;stroke-width:1;" x1="364.999" x2="479.6616" y1="263.0938" y2="263.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85.1475" x="376.999" y="258.0278">Return result</text><polygon fill="#191919" points="149.1299,291.2266,139.1299,295.2266,149.1299,299.2266,145.1299,295.2266" style="stroke:#191919;stroke-width:1;"/><line style="stroke:#191919;stroke-width:1;" x1="143.1299" x2="358.999" y1="295.2266" y2="295.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85.1475" x="155.1299" y="290.1606">Return result</text><path d="M364,279.5938 L364,297.5938 A3.5,3.5 0 0 0 367.5,301.0938 L504.5,301.0938 A3.5,3.5 0 0 0 508,297.5938 L508,286.0938 L498,276.0938 L367.5,276.0938 A3.5,3.5 0 0 0 364,279.5938 " fill="#E5E5E5" style="stroke:#191919;stroke-width:1.5;"/><path d="M498,276.0938 L498,284.3438 A1.75,1.75 0 0 0 499.75,286.0938 L508,286.0938 L498,276.0938 " fill="#E5E5E5" style="stroke:#191919;stroke-width:1.5;"/><text fill="#191919" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123.4365" x="370" y="293.1606">Coroutine resumes</text><polygon fill="#191919" points="34.9551,323.3594,24.9551,327.3594,34.9551,331.3594,30.9551,327.3594" style="stroke:#191919;stroke-width:1;"/><line style="stroke:#191919;stroke-width:1;" x1="28.9551" x2="137.1299" y1="327.3594" y2="327.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77.6255" x="40.9551" y="322.2935">Send Result</text><path d="M74,343.8594 L74,391.8594 A3.5,3.5 0 0 0 77.5,395.3594 L538.5,395.3594 A3.5,3.5 0 0 0 542,391.8594 L542,350.3594 L532,340.3594 L77.5,340.3594 A3.5,3.5 0 0 0 74,343.8594 " fill="#E5E5E5" style="stroke:#191919;stroke-width:1.5;"/><path d="M532,340.3594 L532,348.6094 A1.75,1.75 0 0 0 533.75,350.3594 L542,350.3594 L532,340.3594 " fill="#E5E5E5" style="stroke:#191919;stroke-width:1.5;"/><text fill="#191919" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="314.5454" x="134.1438" y="357.4263">Request thread runs event loop with coroutines.</text><text fill="#191919" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="312.603" x="134.1438" y="372.5591">Each request handled in a coroutine that awaits</text><text fill="#191919" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="339.5933" x="134.1438" y="387.6919">Thread Pool results without blocking the event loop.</text><!--SRC=[TL8xJyCm4DxzAuwmbee12Ia30ssP64gXGaWiRdeqLXqx-2vjVpvd9sb24LxY9D_h7bTSOeLGwK1AwO9zW6nD63BG1F6YrCQV89lvu1is3c7c7UE9CxX-DhkI7ss32kGas0g_6oI6jpAWtWfcSJk_UxfFW7Xg7TWKfjQE1_1PEvcUtn89tJOgg_xPfcdbOUczxNDyeBN-c3YYsg20DEtX9TwJRhgfFo7UVTXZE0SMOFjbS8nTW9k78LWEwzfwyJULtg5IGsy4bMnoMBWs1SSGMgJqKHk6WDHOLiupGeYnyq4MgA5QN6dowIAOu4kcqJ5Kqeq6RRmSvZWunCcPWnRHBdnNrGW-MwvlZ4pEaJaWrC4NI6JSRWJjeg-Gc-1wuorUQWzHHXtvJVgdmFYtGhheMEnl3g-ntwintHyarXavwUq1-htXTWj2umZmW39DwtqDHyCb53sFfi9OwA8KzvPMoZWiolGSw04dQfhRAP4mHXlM5KL9MC2miRxOI-k4WYFZQLgP65tz0000]--></g></svg>